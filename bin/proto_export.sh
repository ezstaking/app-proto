#!/usr/bin/env bash

echo "ðŸ‘‰ Export proto $@"

PROTO_OUTPUT_DIR=$1
DIRS=${@:2}

for dir in $DIRS; do
  PACKAGE=$(echo $dir| cut -d'/' -f 2)

  rm -rf "$PROTO_OUTPUT_DIR/$PACKAGE"

  mkdir -p "$PROTO_OUTPUT_DIR/$PACKAGE"

  echo "Autogenerated folder, see bin/exports_protos.sh" > "$PROTO_OUTPUT_DIR/$PACKAGE/README.md"

  buf export "$dir/" --output "$PROTO_OUTPUT_DIR/$PACKAGE"
done

echo "âœ¨ export done"
